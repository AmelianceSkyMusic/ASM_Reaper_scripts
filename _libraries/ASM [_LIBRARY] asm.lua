--[[
 * ReaScript Name: asm_class.lua
 * Author: Rsay Uaie (Ameliance SkyMusic)
 * Author URI: https://forum.cockos.com/member.php?u=123975
 * Licence: GPL v3
 * REAPER: 5.0
 * Version: 1.0.3
--]]

--[[
 * Changelog:
 * v1.0.0 (2019-03-16)
  + Initial release
 * v1.0.1 (2019-03-30)
  + Add new functions for work with items
 * v1.0.2 (2019-05-12)
  + Add new functions for work with color
 * v1.0.3 (2019-08-01) 
  + Update code
--]]

asm={getRGBA=function(a,b,c,d)local a,b,c,d=a/255,b/255,c/255,d/255;return a,b,c,d end,cheker_nothing=function()end,cheker=function()reaper.defer(asm.cheker_nothing)end,setColor=function(e,f,g,h)gfx.r,gfx.g,gfx.b,gfx.a=asm.getRGBA(e,f,g,h)return e,f,g,h end,setXY=function(x,y)gfx.x,gfx.y=x,y end,getMouseXY=function()x,y=gfx.mouse_x,gfx.mouse_y;return x,y end,doCmdID=function(i,j)if j=='MAIN'then commandID=reaper.NamedCommandLookup(i)reaper.Main_OnCommand(commandID,0)elseif j=='MIDI'then activeMidiEditor=reaper.MIDIEditor_GetActive()commandID=reaper.NamedCommandLookup(i)reaper.MIDIEditor_OnCommand(activeMidiEditor,commandID)end end}function asm.msg(k)reaper.ShowConsoleMsg(tostring(k).."\n")end;function asm.tableJoin(l,m)if l and m then new_concat_table_2=m;new_concat_table_1=l;local n=#m+1;for o,p in pairs(m)do for q,r in pairs(l)do v_1_str=tostring(r)v_2_str=tostring(p)if v_2_str==v_1_str then table.remove(new_concat_table_1,q)break end end end;for s,t in pairs(new_concat_table_1)do new_concat_table_2[n]=t;n=n+1 end;table.sort(new_concat_table_2)end;return new_concat_table_2 end;function asm.countTracksState(u,v)count_tracks_all=reaper.CountTracks(0)if not count_tracks_all then cheker()end;selected_tracks_numb={}local w=1;for n=0,count_tracks_all-1 do local z=reaper.GetTrack(0,n)is_selected=reaper.GetMediaTrackInfo_Value(z,u)==v;if is_selected then selected_tracks_numb[w]=n;w=w+1 end end;if#selected_tracks_numb<1 then selected_tracks_numb=false end;return selected_tracks_numb end;function asm.getCountTrackMediaItems(A)local count_tracks=reaper.CountTracks()local B={}for n=1,count_tracks do get_track_userdata=reaper.GetTrack(0,n-1)count_get_track_items=reaper.CountTrackMediaItems(get_track_userdata)B[n]=count_get_track_items end;return B[A]end;function asm.countTrackAndItem(C)if C==nil then C=0 end;count_tracks=reaper.CountTracks(C)count_items=reaper.CountMediaItems(C)count_sel_tracks=reaper.CountSelectedTracks(C)count_sel_items=reaper.CountSelectedMediaItems(C)return count_tracks,count_items,count_sel_tracks,count_sel_items end;function asm.getItemType(D)local E=reaper.GetMediaItemInfo_Value(D,'I_CURTAKE')local F=reaper.GetMediaItemTake(D,E)local G=reaper.TakeIsMIDI(F)if G==true then itemIs='MIDI'else local H=reaper.GetMediaItemTake_Source(F)local I,J=reaper.CF_GetMediaSourceRPP(H,'subproject')if I==false then itemIs='AUDIO'else itemIs='SUBPROJECT'end end;return itemIs end;function asm.getTrackItemsUserdata(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then local temp_last_item=nil;local L=1;local M=1;local N=1;local O=1;local P=nil;local Q=nil;track_selected_items_userdata_table={}track_unselected_items_userdata_table={}track_before_selected_items_userdata_table={}track_after_selected_items_userdata_table={}track_next_last_sel_item=nil;track_first_prev_sel_item=nil;track_first_prev_sel_item_smart_back=nil;track_next_last_sel_item_smart_back=nil;first_selected_item=nil;last_selected_item=nil;first_track_item=nil;last_track_item=nil;if count_track_items==1 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)last_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)last_track_item=reaper.GetTrackMediaItem(tracks_userdata,count_track_items-1)end;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if is_item_selected then track_selected_items_userdata_table[L]=item;L=L+1;if first_selected_item==nil then first_selected_item=item end;last_selected_item=item else track_unselected_items_userdata_table[M]=item;M=M+1 end;if temp_last_item~=nil then temp_last_item_selected=reaper.IsMediaItemSelected(temp_last_item)if is_item_selected and temp_last_item_selected==false then track_before_selected_items_userdata_table[N]=temp_last_item;N=N+1;if track_first_prev_sel_item==nil then track_first_prev_sel_item=temp_last_item end;if track_first_prev_sel_item_smart_back==nil then track_first_prev_sel_item_smart_back=temp_last_item end;Q=temp_last_item end end;temp_last_item=item;next_item=reaper.GetTrackMediaItem(tracks_userdata,n+1)if next_item~=nil then is_next_item_selected=reaper.IsMediaItemSelected(next_item)if is_item_selected and is_next_item_selected~=true then track_after_selected_items_userdata_table[O]=next_item;O=O+1;track_next_last_sel_item=next_item;if P==nil then P=next_item end;track_next_last_sel_item_smart_back=next_item end end;is_first_item_selected=reaper.IsMediaItemSelected(first_track_item)if is_first_item_selected then track_first_prev_sel_item=nil;track_first_prev_sel_item_smart_back=P end;is_last_item_selected=reaper.IsMediaItemSelected(last_track_item)if is_last_item_selected then track_next_last_sel_item=nil;track_next_last_sel_item_smart_back=Q end end end;return track_selected_items_userdata_table,track_unselected_items_userdata_table,track_before_selected_items_userdata_table,track_after_selected_items_userdata_table,track_first_prev_sel_item,track_next_last_sel_item,track_first_prev_sel_item_smart_back,track_next_last_sel_item_smart_back,first_selected_item,last_selected_item,first_track_item,last_track_item end;function asm.doItems(R,S,T,U,V,W,X,Y,Z,_,a0,a1,a2,a3,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_selected_items_userdata_table={}TB_track_unselected_items_userdata_table={}TB_track_before_selected_items_userdata_table={}TB_track_after_selected_items_userdata_table={}TB_track_first_prev_sel_item={}TB_track_next_last_sel_item={}TB_track_first_prev_sel_item_smart_back={}TB_track_next_last_sel_item_smart_back={}TB_first_selected_item={}TB_last_selected_item={}TB_first_track_item={}TB_last_track_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_selected_items_userdata_table,get_track_unselected_items_userdata_table,get_track_before_selected_items_userdata_table,get_track_after_selected_items_userdata_table,get_track_first_prev_sel_item,get_track_next_last_sel_item,get_track_first_prev_sel_item_smart_back,get_track_next_last_sel_item_smart_back,get_first_selected_item,get_last_selected_item,get_first_track_item,get_last_track_item=asm.getTrackItemsUserdata(idx_track_sel_track)if get_track_selected_items_userdata_table~=nil then for s,t in pairs(get_track_selected_items_userdata_table)do TB_track_selected_items_userdata_table[#TB_track_selected_items_userdata_table+1]=t end end;if get_track_unselected_items_userdata_table~=nil then for s,t in pairs(get_track_unselected_items_userdata_table)do TB_track_unselected_items_userdata_table[#TB_track_unselected_items_userdata_table+1]=t end end;if get_track_before_selected_items_userdata_table~=nil then for s,t in pairs(get_track_before_selected_items_userdata_table)do TB_track_before_selected_items_userdata_table[#TB_track_before_selected_items_userdata_table+1]=t end end;if get_track_after_selected_items_userdata_table~=nil then for s,t in pairs(get_track_after_selected_items_userdata_table)do TB_track_after_selected_items_userdata_table[#TB_track_after_selected_items_userdata_table+1]=t end end;if get_track_first_prev_sel_item~=nil then TB_track_first_prev_sel_item[#TB_track_first_prev_sel_item+1]=get_track_first_prev_sel_item end;if get_track_next_last_sel_item~=nil then TB_track_next_last_sel_item[#TB_track_next_last_sel_item+1]=get_track_next_last_sel_item end;if get_track_first_prev_sel_item_smart_back~=nil then TB_track_first_prev_sel_item_smart_back[#TB_track_first_prev_sel_item_smart_back+1]=get_track_first_prev_sel_item_smart_back end;if get_track_next_last_sel_item_smart_back~=nil then TB_track_next_last_sel_item_smart_back[#TB_track_next_last_sel_item_smart_back+1]=get_track_next_last_sel_item_smart_back end;if get_first_selected_item~=nil then TB_first_selected_item[#TB_first_selected_item+1]=get_first_selected_item end;if get_last_selected_item~=nil then TB_last_selected_item[#TB_last_selected_item+1]=get_last_selected_item end;if get_first_track_item~=nil then TB_first_track_item[#TB_first_track_item+1]=get_first_track_item end;if get_last_track_item~=nil then TB_last_track_item[#TB_last_track_item+1]=get_last_track_item end end;if T~=nil and TB_track_selected_items_userdata_table~=nil then for s,t in pairs(TB_track_selected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)T(t,v_item_track)end end end;if U~=nil and TB_track_unselected_items_userdata_table~=nil then for s,t in pairs(TB_track_unselected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)U(t,v_item_track)end end end;if V~=nil and TB_track_before_selected_items_userdata_table~=nil then for s,t in pairs(TB_track_before_selected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)V(t,v_item_track)end end end;if W~=nil and TB_track_after_selected_items_userdata_table~=nil then for s,t in pairs(TB_track_after_selected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)W(t,v_item_track)end end end;if X~=nil and TB_track_first_prev_sel_item~=nil then for s,t in pairs(TB_track_first_prev_sel_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)X(t,v_item_track)end end end;if Y~=nil and TB_track_next_last_sel_item~=nil then for s,t in pairs(TB_track_next_last_sel_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)Y(t,v_item_track)end end end;if Z~=nil and TB_track_first_prev_sel_item_smart_back~=nil then for s,t in pairs(TB_track_first_prev_sel_item_smart_back)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)Z(t,v_item_track)end end end;if _~=nil and TB_track_next_last_sel_item_smart_back~=nil then for s,t in pairs(TB_track_next_last_sel_item_smart_back)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)_(t,v_item_track)end end end;if a0~=nil and TB_first_selected_item~=nil then for s,t in pairs(TB_first_selected_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a0(t,v_item_track)end end end;if a1~=nil and TB_last_selected_item~=nil then for s,t in pairs(TB_last_selected_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a1(t,v_item_track)end end end;if a2~=nil and TB_first_track_item~=nil then for s,t in pairs(TB_first_track_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a2(t,v_item_track)end end end;if a3~=nil and TB_last_track_item~=nil then for s,t in pairs(TB_last_track_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a3(t,v_item_track)end end end;return TB_track_selected_items_userdata_table,TB_track_unselected_items_userdata_table,TB_track_before_selected_items_userdata_table,TB_track_after_selected_items_userdata_table,TB_track_next_last_sel_item,TB_track_first_prev_sel_item,TB_first_selected_item,TB_last_selected_item,TB_first_track_item,TB_last_track_item end;asm.getMediaItemsUserdata={}function asm.getMediaItemsUserdata.allSelItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then local L=1;track_selected_items_userdata_table={}for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if is_item_selected then track_selected_items_userdata_table[L]=item;L=L+1 end end end;return track_selected_items_userdata_table end;function asm.getMediaItemsUserdata.allUnselItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then local M=1;track_unselected_items_userdata_table={}for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if is_item_selected~=true then track_unselected_items_userdata_table[M]=item;M=M+1 end end end;return track_unselected_items_userdata_table end;function asm.getMediaItemsUserdata.beforeSelItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then local temp_last_item=nil;local N=1;track_before_selected_items_userdata_table={}for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if temp_last_item~=nil then temp_last_item_selected=reaper.IsMediaItemSelected(temp_last_item)if is_item_selected and temp_last_item_selected==false then track_before_selected_items_userdata_table[N]=temp_last_item;N=N+1 end end;temp_last_item=item end end;return track_before_selected_items_userdata_table end;function asm.getMediaItemsUserdata.afterSelItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then local O=1;track_after_selected_items_userdata_table={}for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)next_item=reaper.GetTrackMediaItem(tracks_userdata,n+1)if next_item~=nil then is_next_item_selected=reaper.IsMediaItemSelected(next_item)if is_item_selected and is_next_item_selected~=true then track_after_selected_items_userdata_table[O]=next_item;O=O+1 end end end end;return track_after_selected_items_userdata_table end;function asm.getMediaItemsUserdata.firstPrevSelItem(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then track_first_prev_sel_item=nil;first_track_item=nil;if count_track_items==1 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)end;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if temp_last_item~=nil then temp_last_item_selected=reaper.IsMediaItemSelected(temp_last_item)if is_item_selected and temp_last_item_selected==false then if track_first_prev_sel_item==nil then track_first_prev_sel_item=temp_last_item end end end;temp_last_item=item;is_first_item_selected=reaper.IsMediaItemSelected(first_track_item)if is_first_item_selected then track_first_prev_sel_item=nil end end end;return track_first_prev_sel_item end;function asm.getMediaItemsUserdata.nextLastSelItem(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then track_next_last_sel_item=nil;last_track_item=nil;if count_track_items==1 then last_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then last_track_item=reaper.GetTrackMediaItem(tracks_userdata,count_track_items-1)end;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)next_item=reaper.GetTrackMediaItem(tracks_userdata,n+1)if next_item~=nil then is_next_item_selected=reaper.IsMediaItemSelected(next_item)if is_item_selected and is_next_item_selected~=true then track_next_last_sel_item=next_item end end;is_last_item_selected=reaper.IsMediaItemSelected(last_track_item)if is_last_item_selected then track_next_last_sel_item=nil end end end;return track_next_last_sel_item end;function asm.getMediaItemsUserdata.firstPrevSelItemSmartBack(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then track_first_prev_sel_item_smart_back=nil;first_track_item=nil;track_next_last_sel_item=nil;last_track_item=nil;if count_track_items==1 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)last_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)last_track_item=reaper.GetTrackMediaItem(tracks_userdata,count_track_items-1)end;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if temp_last_item~=nil then temp_last_item_selected=reaper.IsMediaItemSelected(temp_last_item)if is_item_selected and temp_last_item_selected==false then if track_first_prev_sel_item_smart_back==nil then track_first_prev_sel_item_smart_back=temp_last_item end end end;temp_last_item=item;is_first_item_selected=reaper.IsMediaItemSelected(first_track_item)if is_first_item_selected then next_item=reaper.GetTrackMediaItem(tracks_userdata,n+1)if next_item~=nil then is_next_item_selected=reaper.IsMediaItemSelected(next_item)if is_item_selected and is_next_item_selected~=true then if track_next_last_sel_item==nil then track_next_last_sel_item=next_item end end end;track_first_prev_sel_item_smart_back=track_next_last_sel_item end end end;return track_first_prev_sel_item_smart_back end;function asm.getMediaItemsUserdata.nextLastSelItemSmartBack(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then track_next_last_sel_item_smart_back=nil;last_track_item=nil;track_first_prev_sel_item=nil;first_track_item=nil;if count_track_items==1 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)last_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)last_track_item=reaper.GetTrackMediaItem(tracks_userdata,count_track_items-1)end;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)next_item=reaper.GetTrackMediaItem(tracks_userdata,n+1)if next_item~=nil then is_next_item_selected=reaper.IsMediaItemSelected(next_item)if is_item_selected and is_next_item_selected~=true then track_next_last_sel_item_smart_back=next_item end end;is_last_item_selected=reaper.IsMediaItemSelected(last_track_item)if is_last_item_selected then if temp_last_item~=nil then temp_last_item_selected=reaper.IsMediaItemSelected(temp_last_item)if is_item_selected and temp_last_item_selected==false then track_first_prev_sel_item=temp_last_item end end;temp_last_item=item;track_next_last_sel_item_smart_back=track_first_prev_sel_item end end end;return track_next_last_sel_item_smart_back end;function asm.getMediaItemsUserdata.firstSelItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then first_selected_item=nil;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if is_item_selected then if first_selected_item==nil then first_selected_item=item end end end end;return first_selected_item end;function asm.getMediaItemsUserdata.lastSelItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then last_selected_item=nil;for n=0,count_track_items-1 do item=reaper.GetTrackMediaItem(tracks_userdata,n)is_item_selected=reaper.IsMediaItemSelected(item)if is_item_selected then last_selected_item=item end end end;return last_selected_item end;function asm.getMediaItemsUserdata.firsItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then first_track_item=nil;if count_track_items==1 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then first_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)end end;return first_track_item end;function asm.getMediaItemsUserdata.lastItems(K,C)if C==nil then C=0 end;tracks_userdata=reaper.GetTrack(C,K-1)count_track_items=reaper.CountTrackMediaItems(tracks_userdata)if count_track_items>=1 then last_track_item=nil;if count_track_items==1 then last_track_item=reaper.GetTrackMediaItem(tracks_userdata,0)elseif count_track_items>=2 then last_track_item=reaper.GetTrackMediaItem(tracks_userdata,count_track_items-1)end end;return last_track_item end;asm.doMediaItems={}function asm.doMediaItems.allSelItems(R,S,T,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_selected_items_userdata_table={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_selected_items_userdata_table=asm.getMediaItemsUserdata.allSelItems(idx_track_sel_track)if get_track_selected_items_userdata_table~=nil then for s,t in pairs(get_track_selected_items_userdata_table)do TB_track_selected_items_userdata_table[#TB_track_selected_items_userdata_table+1]=t end end end;if T~=nil and TB_track_selected_items_userdata_table~=nil then for s,t in pairs(TB_track_selected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)T(t,v_item_track)end end end;return TB_track_selected_items_userdata_table end;function asm.doMediaItems.allUnselItems(R,S,U,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_unselected_items_userdata_table={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_unselected_items_userdata_table=asm.getMediaItemsUserdata.allUnselItems(idx_track_sel_track)if get_track_unselected_items_userdata_table~=nil then for s,t in pairs(get_track_unselected_items_userdata_table)do TB_track_unselected_items_userdata_table[#TB_track_unselected_items_userdata_table+1]=t end end end;if U~=nil and TB_track_unselected_items_userdata_table~=nil then for s,t in pairs(TB_track_unselected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)U(t,v_item_track)end end end;return TB_track_unselected_items_userdata_table end;function asm.doMediaItems.beforeSelItems(R,S,V,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_before_selected_items_userdata_table={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_before_selected_items_userdata_table=asm.getMediaItemsUserdata.beforeSelItems(idx_track_sel_track)if get_track_before_selected_items_userdata_table~=nil then for s,t in pairs(get_track_before_selected_items_userdata_table)do TB_track_before_selected_items_userdata_table[#TB_track_before_selected_items_userdata_table+1]=t end end end;if V~=nil and TB_track_before_selected_items_userdata_table~=nil then for s,t in pairs(TB_track_before_selected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)V(t,v_item_track)end end end;return TB_track_before_selected_items_userdata_table end;function asm.doMediaItems.afterSelItems(R,S,W,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_after_selected_items_userdata_table={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_after_selected_items_userdata_table=asm.getMediaItemsUserdata.afterSelItems(idx_track_sel_track)if get_track_after_selected_items_userdata_table~=nil then for s,t in pairs(get_track_after_selected_items_userdata_table)do TB_track_after_selected_items_userdata_table[#TB_track_after_selected_items_userdata_table+1]=t end end end;if W~=nil and TB_track_after_selected_items_userdata_table~=nil then for s,t in pairs(TB_track_after_selected_items_userdata_table)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)W(t,v_item_track)end end end;return TB_track_after_selected_items_userdata_table end;function asm.doMediaItems.firstPrevSelItem(R,S,X,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_first_prev_sel_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_first_prev_sel_item=asm.getMediaItemsUserdata.firstPrevSelItem(idx_track_sel_track)if get_track_first_prev_sel_item~=nil then TB_track_first_prev_sel_item[#TB_track_first_prev_sel_item+1]=get_track_first_prev_sel_item end end;if X~=nil and TB_track_first_prev_sel_item~=nil then for s,t in pairs(TB_track_first_prev_sel_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)X(t,v_item_track)end end end;return TB_track_first_prev_sel_item end;function asm.doMediaItems.nextLastSelItem(R,S,Y,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_next_last_sel_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_next_last_sel_item=asm.getMediaItemsUserdata.nextLastSelItem(idx_track_sel_track)if get_track_next_last_sel_item~=nil then TB_track_next_last_sel_item[#TB_track_next_last_sel_item+1]=get_track_next_last_sel_item end end;if Y~=nil and TB_track_next_last_sel_item~=nil then for s,t in pairs(TB_track_next_last_sel_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)Y(t,v_item_track)end end end;return TB_track_next_last_sel_item end;function asm.doMediaItems.firstPrevSelItemSmartBack(R,S,Z,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_first_prev_sel_item_smart_back={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_first_prev_sel_item_smart_back=asm.getMediaItemsUserdata.firstPrevSelItemSmartBack(idx_track_sel_track)if get_track_first_prev_sel_item_smart_back~=nil then TB_track_first_prev_sel_item_smart_back[#TB_track_first_prev_sel_item_smart_back+1]=get_track_first_prev_sel_item_smart_back end end;if Z~=nil and TB_track_first_prev_sel_item_smart_back~=nil then for s,t in pairs(TB_track_first_prev_sel_item_smart_back)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)Z(t,v_item_track)end end end;return TB_track_first_prev_sel_item_smart_back end;function asm.doMediaItems.nextLastSelItemSmartBack(R,S,_,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_track_next_last_sel_item_smart_back={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_track_next_last_sel_item_smart_back=asm.getMediaItemsUserdata.nextLastSelItemSmartBack(idx_track_sel_track)if get_track_next_last_sel_item_smart_back~=nil then TB_track_next_last_sel_item_smart_back[#TB_track_next_last_sel_item_smart_back+1]=get_track_next_last_sel_item_smart_back end end;if _~=nil and TB_track_next_last_sel_item_smart_back~=nil then for s,t in pairs(TB_track_next_last_sel_item_smart_back)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)_(t,v_item_track)end end end;return TB_track_next_last_sel_item_smart_back end;function asm.doMediaItems.firstSelItems(R,S,a0,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_first_selected_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_first_selected_item=asm.getMediaItemsUserdata.firstSelItems(idx_track_sel_track)if get_first_selected_item~=nil then TB_first_selected_item[#TB_first_selected_item+1]=get_first_selected_item end end;if a0~=nil and TB_first_selected_item~=nil then for s,t in pairs(TB_first_selected_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a0(t,v_item_track)end end end;return TB_first_selected_item end;function asm.doMediaItems.lastSelItems(R,S,a1,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_last_selected_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_last_selected_item=asm.getMediaItemsUserdata.lastSelItems(idx_track_sel_track)if get_last_selected_item~=nil then TB_last_selected_item[#TB_last_selected_item+1]=get_last_selected_item end end;if a1~=nil and TB_last_selected_item~=nil then for s,t in pairs(TB_last_selected_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a1(t,v_item_track)end end end;return TB_last_selected_item end;function asm.doMediaItems.firsItems(R,S,a2,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_first_track_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_first_track_item=asm.getMediaItemsUserdata.firsItems(idx_track_sel_track)if get_first_track_item~=nil then TB_first_track_item[#TB_first_track_item+1]=get_first_track_item end end;if a2~=nil and TB_first_track_item~=nil then for s,t in pairs(TB_first_track_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a2(t,v_item_track)end end end;return TB_first_track_item end;function asm.doMediaItems.lastItems(R,S,a3,C)if C==nil then C=0 end;if S=='SEL_ITEM'then count_sel_items=reaper.CountSelectedMediaItems(C)idx_sel_item_track_table={}sel_item_track_i=1;idx_sel_item_track_old=-100;count_sel_item_track=0;for n=0,count_sel_items-1 do sel_item=reaper.GetSelectedMediaItem(C,n)sel_item_track=reaper.GetMediaItemTrack(sel_item)idx_sel_item_track=reaper.GetMediaTrackInfo_Value(sel_item_track,'IP_TRACKNUMBER')if idx_sel_item_track~=idx_sel_item_track_old then idx_sel_item_track_table[sel_item_track_i]=idx_sel_item_track;sel_item_track_i=sel_item_track_i+1;idx_sel_item_track_old=idx_sel_item_track;count_sel_item_track=count_sel_item_track+1 end end;count_sel_tracks=count_sel_item_track elseif S=='SEL_TRACK'then count_sel_tracks=reaper.CountSelectedTracks(C)elseif S=='ONE_TRACK'then count_sel_tracks=1 else return end;TB_last_track_item={}for n=0,count_sel_tracks-1 do if S=='SEL_ITEM'then idx_track_sel_track=idx_sel_item_track_table[n+1]elseif S=='SEL_TRACK'then sel_track=reaper.GetSelectedTrack(C,n)idx_track_sel_track=reaper.GetMediaTrackInfo_Value(sel_track,'IP_TRACKNUMBER')elseif S=='ONE_TRACK'then idx_track_sel_track=R end;get_last_track_item=asm.getMediaItemsUserdata.lastItems(idx_track_sel_track)if get_last_track_item~=nil then TB_last_track_item[#TB_last_track_item+1]=get_last_track_item end end;if a3~=nil and TB_last_track_item~=nil then for s,t in pairs(TB_last_track_item)do if t~=nil then v_item_track=reaper.GetMediaItemTrack(t)a3(t,v_item_track)end end end;return TB_last_track_item end

----------------------------------------------------------------
------------------------- DESCRIPTION --------------------------
----------------------------------------------------------------
--function ACTION_FUNCTION(temp_item, temp_track)
--end

------ (_, '', 1_all_sel, 2_all_unsel, 3_all_before_sel, 4_all_after_sel,
------      5_first_before_sel, 6_last_after_sel, 7_first_before_sel_smart_back, 8_last_after_sel_smart_back,
------      7_first_sel, 10_last_sel, 11_first, 12_last, proj)
--asm.doTrackItems(_idx, 'SEL_ITEM', _1, _2, _3, _4, _5, _6, _7, _8, _9, _10, _11, _12)

------ idx_of_track

------ 'SEL_ITEM' - use items on traks with selected items
------ 'SEL_TRACK' - use items on selected traks
------ 'ONE_TRACK' - use items on idx_of_track (1st parameter) tracks
------ (idx_of_track, 'SEL_ITEM', ACTION_FUNCTION)

--asm.doMediaItems.allSelItems      (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 1 - all selected items in track
--asm.doMediaItems.allUnselItems    (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 2 - all unselected items in track
--asm.doMediaItems.beforeSelItems   (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 3 - all items before even selected in track
--asm.doMediaItems.afterSelItems    (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 4 - all items after even selected in track
--asm.doMediaItems.firstPrevSelItem (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 5 - one first item before first selected items in track
--asm.doMediaItems.nextLastSelItem  (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 6 - one last item after last selected items in track
--asm.doMediaItems.firstPrevSelItemSmartBack (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 7 - one first item before first selected items in track
--asm.doMediaItems.nextLastSelItemSmartBack  (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 8 - one last item after last selected items in track
--asm.doMediaItems.firstSelItems    (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 9 - one first selected item
--asm.doMediaItems.lastSelItems     (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 10 - one last selected item
--asm.doMediaItems.firsItems        (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 11 - first item in track
--asm.doMediaItems.lastItems        (_, 'SEL_ITEM', _ACTION_FUNCTION)  -- 12 - last item in track
----------------------------------------------------------------
----------------------------------------------------------------
----------------------------------------------------------------

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
--[[function asm.msg(message)
  reaper.ShowConsoleMsg('"'..tostring(message)..'": '..tostring(message).."\n")
  --reaper.ShowConsoleMsg("")
end]]--


--[[function asm.getTextWindow(title, fields_num, field_title, field_text)
  is_text, get_text_stop = reaper.GetUserInputs(title, fields_num, field_title, field_text)
  if is_text then
    text = get_text_stop
  end
  return text
end]]
